[gd_scene load_steps=17 format=3 uid="uid://dnbetsyspg7f1"]

[ext_resource type="PackedScene" uid="uid://djh6p5vpl0qh6" path="res://Nodes/FPS_Controller.tscn" id="1_6ibw4"]
[ext_resource type="Environment" uid="uid://cff7nt30ah6bl" path="res://Misc/FoggyEnvDark.tres" id="2_1t0lb"]
[ext_resource type="PackedScene" uid="uid://d1sr2jxw7eh73" path="res://Nodes/film_camera.tscn" id="3_xs7wa"]
[ext_resource type="Script" path="res://Scripts/photo_taker.gd" id="4_mtp5q"]
[ext_resource type="PackedScene" uid="uid://cu438pyjavfwu" path="res://Nodes/camera_film.tscn" id="5_a7snp"]
[ext_resource type="PackedScene" uid="uid://d07pqfwflwq4g" path="res://Nodes/photo_grader.tscn" id="6_yk7rx"]
[ext_resource type="PackedScene" uid="uid://bt2cs3l4w0elj" path="res://Assets/Sqwamtch/sqwamtch_character.tscn" id="7_fmn67"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_0rvcj"]

[sub_resource type="CylinderMesh" id="CylinderMesh_rkbv3"]
material = SubResource("StandardMaterial3D_0rvcj")

[sub_resource type="BoxMesh" id="BoxMesh_j5cc0"]
size = Vector3(20, 0.1, 20)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_38ilr"]
data = PackedVector3Array(-10, 0.05, 10, 10, 0.05, 10, -10, -0.05, 10, 10, 0.05, 10, 10, -0.05, 10, -10, -0.05, 10, 10, 0.05, -10, -10, 0.05, -10, 10, -0.05, -10, -10, 0.05, -10, -10, -0.05, -10, 10, -0.05, -10, 10, 0.05, 10, 10, 0.05, -10, 10, -0.05, 10, 10, 0.05, -10, 10, -0.05, -10, 10, -0.05, 10, -10, 0.05, -10, -10, 0.05, 10, -10, -0.05, -10, -10, 0.05, 10, -10, -0.05, 10, -10, -0.05, -10, 10, 0.05, 10, -10, 0.05, 10, 10, 0.05, -10, -10, 0.05, 10, -10, 0.05, -10, 10, 0.05, -10, -10, -0.05, 10, 10, -0.05, 10, -10, -0.05, -10, 10, -0.05, 10, 10, -0.05, -10, -10, -0.05, -10)

[sub_resource type="CameraAttributesPractical" id="CameraAttributesPractical_dtv36"]

[sub_resource type="ViewportTexture" id="ViewportTexture_2s2lx"]
viewport_path = NodePath("SubViewport")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_mtsdm"]
resource_local_to_scene = true
albedo_texture = SubResource("ViewportTexture_2s2lx")

[sub_resource type="QuadMesh" id="QuadMesh_xbj2u"]
resource_local_to_scene = true
material = SubResource("StandardMaterial3D_mtsdm")

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_sxs8a"]
radius = 5.173
height = 15.0

[node name="Node3D" type="Node3D"]

[node name="MeshInstance3D3" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.80966, 1.00222, -5.39954)
mesh = SubResource("CylinderMesh_rkbv3")

[node name="MeshInstance3D5" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.57808, 1.00222, -2.86811)
mesh = SubResource("CylinderMesh_rkbv3")

[node name="FPSController" parent="." instance=ExtResource("1_6ibw4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.71732, 1.47861, 3)

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(0.999996, 0.00250743, -0.00105944, -0.0025075, 0.999997, -5.78445e-05, 0.0010593, 6.04929e-05, 0.999999, 0, 0, 0)
mesh = SubResource("BoxMesh_j5cc0")

[node name="StaticBody3D" type="StaticBody3D" parent="MeshInstance3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_38ilr")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.67622, -0.386819, 0.626974, 0, 0.851059, 0.525071, -0.736699, -0.355064, 0.575503, 0, 3.74052, 0)
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource("2_1t0lb")
camera_attributes = SubResource("CameraAttributesPractical_dtv36")

[node name="MeshInstance3D4" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.25566, 1.58575, 0)
mesh = SubResource("QuadMesh_xbj2u")

[node name="SubViewport" type="SubViewport" parent="."]
size = Vector2i(256, 256)
render_target_update_mode = 4

[node name="FilmCam" parent="SubViewport" instance=ExtResource("3_xs7wa")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 1, 0)
skeleton = NodePath("../..")

[node name="PhotoTaker" type="Node3D" parent="."]
script = ExtResource("4_mtp5q")
film_asset = ExtResource("5_a7snp")

[node name="PhotoGrader" parent="." instance=ExtResource("6_yk7rx")]

[node name="Sqwamtch" parent="." instance=ExtResource("7_fmn67")]
transform = Transform3D(0.15, 0, 0, 0, 0.15, 0, 0, 0, 0.15, 0.727634, 0.0482574, -1.35093)

[node name="CharacterBody3D" type="CharacterBody3D" parent="Sqwamtch"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Sqwamtch/CharacterBody3D" groups=["EnemyCollision"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 8.07946, 1.33981)
shape = SubResource("CapsuleShape3D_sxs8a")

[connection signal="before_take_photo" from="PhotoTaker" to="SubViewport/FilmCam" method="_on_photo_taker_before_take_photo"]
[connection signal="camera_ready" from="PhotoTaker" to="SubViewport/FilmCam" method="on_camera_reset"]
[connection signal="take_photo" from="PhotoTaker" to="FPSController" method="_on_photo_taker_take_photo"]
[connection signal="take_photo" from="PhotoTaker" to="SubViewport/FilmCam" method="on_photo_taken"]
